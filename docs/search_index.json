[["데이터-시각화.html", "Chapter 7 데이터 시각화 7.1 데이터 시각화 이해 7.2 R base graphics 7.3 ggplot2 패키지", " Chapter 7 데이터 시각화 7.1 데이터 시각화 이해 7.1.1 데이터 시각화(data visualization) 데이터나 정보를 그래프, 차트 등 시각적 형식으로 표현하는 것 시각적 이미지는 보다 직관적인 인식을 가능하게 하고 강렬한 인상을 남김 다양한 시각화를 통해 데이터에 대한 다층적인 이해 가능 빅데이터를 효과적으로 요약하고 전달할 수 있음 7.1.2 데이터 유형에 따른 시각화 방법 유형 설명 예제 시각화 방법 범주형 데이터 (categorical data) - 집단으로 구분되는 데이터 - 기본적으로 숫자로 표현할 수 없음 - 대소비교, 산술연산 불가능 성별, 종교 - 막대 그래프(bar chart) - 원 그래프(pie chart) 수치형 데이터 (numerical data) - 수치 값을 가지는 데이터 - 대소비교, 산술연산 가능 키, 몸무게 - 히스토그램(histogram) - 상자 그림(box plot) - 산점도(scatter plot) - 선 그래프(line plot) 7.2 R base graphics R에 기본적으로 내장되어 있는 데이터 시각화 도구 다양한 종류의 그래프 생성이 가능하며, 매개변수를 통해 세부적인 그래픽 요소를 설정할 수 있음 7.3 ggplot2 패키지 7.3.1 ggplot2 패키지 소개 범용성, 명료함, 일관성 있는 인터페이스, 미적인 그래픽 결과를 제공하는 패키지 Leland Wilkinson(2005)이 제한한 그래픽 문법(grammar of graphics)을 구현함 현재 R을 활용한 데이터 시각화의 표준으로 자리 잡고 있음 독립적인 시각적 구성요소를 정의하고, 이를 층층이 쌓아올리는 방식으로 그래프를 생성 원시 데이터를 나타내는 층(layer)를 먼저 정의한 후, 각종 주석이나 통계 객체 등을 추가할 수 있음 시각화 과정을 표준화하므로 그래픽 문법에 익숙해지면 다양한 그래프를 자유자재로 그릴 수 있음 그래픽 문법의 7가지 요소 요소 설명 data 데이터 aesthetics 시각적 표현 양식(x축, y축, 크기, 색상, 모양 등) geometries 시각화 그래픽 요소(기하 객체)(점, 선, 막대 등) facets 화면 분할 statistics 통계량 coordinates 좌표계 theme 그래프 꾸미기 7.3.2 ggplot2 기본 구조 가장 기본적인 구조는 ggplot() 함수와 geom_ 계열 함수로 구성됨 각 구성요소는 +로 연결되며, 줄 바꿈 시에는 반드시 +는 줄 마지막에 위치해야 함 ggplot() 함수 좌표 시스템(빈 그래프)을 생성하며, 이후 레이어를 추가하여 그래프를 완성 첫 번째 매개변수는 데이터프레임(data frame)을 지정 geom_ 계열 함수 ggplot 객체에 다양한 유형의 레이어를 추가 범주형 데이터 시각화 - geom_bar() 수치형 데이터 시각화 - geom_histogram(), geom_boxplot(), geom_point(), geom_line() ggplot(data = &lt;DATA&gt;) + &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;)) 7.3.3 막대 그래프(bar chart) 범주형 데이터를 시각화한 것으로, 집단별 빈도를 막대로 나타낸 그래프 [예제] 다이아몬드 가격 데이터셋 diamonds cut : 컷 품질(Fair, Good, Very Good, Premium, Ideal) color : 다이아몬드 색상(from D(best) to J(worst)) clarity : 다이아몬드 투명도(I1(worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF(best)) library(ggplot2) ## Example 1 # 컷 품질에 대한 막대 그래프 ggplot(diamonds, aes(x = cut)) + geom_bar() ggplot(diamonds, aes(x = cut)) + geom_bar(fill =&quot;orange&quot;) ggplot(diamonds, aes(x = cut, fill = cut)) + geom_bar() ## Example 2 # 컷 품질, 다이아몬드 투명도에 대한 막대 그래프 p &lt;- ggplot(diamonds, aes(x = cut, fill = clarity)) p + geom_bar() # 누적 막대 그래프 p + geom_bar(position=&quot;fill&quot;) # 100% 누적 막대 그래프 p + geom_bar(position=&quot;dodge&quot;) p + geom_bar(position=&quot;identity&quot;, alpha = 0.2) ## Example 3 # 인종의 빈도가 큰 순서대로 시각화 library(forcats) library(dplyr) gss_cat %&gt;% mutate(race = fct_infreq(race)) %&gt;% # 각 수준의 빈도가 큰 순서대로 재정렬 ggplot(aes(race, fill = race)) + geom_bar() + scale_x_discrete(drop = FALSE) + # 관측값이 없는 수준(levels)도 표시 scale_fill_manual(values = c(&quot;#d1495b&quot;, &quot;#edae49&quot;, &quot;#66a182&quot;, &quot;#2389da&quot;)) + labs(x = &quot;&quot;, y = &quot;Frequency&quot;) + theme(axis.title.y = element_text(size = 15, margin = margin(r=10)), axis.text.x = element_text(size = 12), legend.position = &quot;none&quot;) ## Example 4 # 항공편 출발 요일의 분포 시각화 library(lubridate) library(nycflights13) # 예정된 도착 일시, 실제 출발 일시, 실제 도착 일시를 date-time 형식으로 생성 make_datetime_100 &lt;- function(year, month, day, time) { make_datetime(year, month, day, time %/% 100, time %% 100) } flights_dt &lt;- flights %&gt;% filter(!is.na(dep_time), !is.na(arr_time)) %&gt;% mutate(dep_time = make_datetime_100(year, month, day, dep_time), arr_time = make_datetime_100(year, month, day, arr_time), sched_dep_time = make_datetime_100(year, month, day, sched_dep_time), sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)) %&gt;% select(origin, dest, ends_with(&quot;delay&quot;), ends_with(&quot;time&quot;)) # 시각화 library(RColorBrewer) flights_dt %&gt;% mutate(wday = wday(dep_time, label = TRUE)) %&gt;% ggplot(aes(x = wday, fill = wday)) + geom_bar() + scale_fill_manual(values = brewer.pal(7, &quot;Spectral&quot;)) + labs(x = &quot;&quot;, y = &quot;Frequency&quot;) + theme(legend.position = &quot;none&quot;) 7.3.4 히스토그램(histogram) 수치형 데이터를 일정 구간으로 나눈 후, 각 구간별 빈도를 막대로 나타낸 그래프 [예제] 저체중 출생아 관련 데이터셋 birthwt smoke : 임신 중 흡연 여부(1=Yes, 0=No) bwt : 출생 체중(g) ## Example 1 # 출생 체중에 대한 히스토그램 library(MASS) ggplot(birthwt, aes(x = bwt)) + geom_histogram(fill = &quot;darkgreen&quot;) + labs(title=&quot;Histogram of birthweigth&quot;, x = &quot;Birthweight(in gram)&quot;, y =&quot;&quot;) + theme_classic() ## Example 2 # 임신 중 흡연 여부에 따른 출생 체중의 분포 비교 labels &lt;- c(&quot;1&quot; = &quot;Smoker&quot;, &quot;0&quot; = &quot;Nonsmoker&quot;) ggplot(birthwt, aes(x = bwt, fill = smoke)) + geom_histogram(binwidth = 200) + labs(title=&quot;Histogram of birthweigth&quot;, x = &quot;Birthweight(in gram)&quot;, y =&quot;&quot;) + facet_grid(smoke ~ ., labeller = labeller(smoke = labels)) + theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;) 7.3.5 상자 그림(box plot) 다섯숫자 요약값(five number summary)에 기반으로 한 그래프 사분위수(quantile) - 데이터를 크기 순으로 정렬한 후, 사등분하는 값 최소값 1사분위수(Q1) : 관측값의 25% 순서에 있는 값 중앙값(median) : 관측값의 50% 순서에 있는 값 3사분위수(Q3) : 관측값의 75% 순서에 있는 값 최대값 사분위수범위(IQR) = Q3 - Q1 일반 범위 (Q1 - 1.5*IQR, Q3 + 1.5*IQR)를 벗어난 경우를 이상치(outlier)로 판단 집단별 수치형 데이터의 분포를 비교하는데 유용 [예제] birthwt 데이터셋 race : mother’s race (1 = white, 2 = black, 3 = other) smoke : smoking status during pregnancy (1=Yes, 0=No) ui : presence of uterine irritability (1=Yes, 0=No) bwt : birth weight in grams ggplot(birthwt, aes(x = factor(race), y = bwt)) + geom_boxplot() + coord_flip() bp &lt;- birthwt %&gt;% mutate(smoke = fct_recode(as_factor(smoke), &quot;Smoker&quot; = &quot;1&quot;, &quot;Nonsmoker&quot; = &quot;0&quot;), ui = fct_recode(as_factor(ui), &quot;Presence&quot; = &quot;1&quot;, &quot;None&quot; = &quot;0&quot;)) %&gt;% ggplot(aes(x = factor(race), y = bwt)) + geom_boxplot() + facet_grid(ui ~ smoke) bp + geom_point(color = &quot;steelblue&quot;, alpha = 0.5) bp + geom_jitter(color = &quot;steelblue&quot;, alpha = 0.5) 7.3.6 산점도(scatter plot) 두 연속형 변수의 관측 순서쌍을 이차원 평면 상에 점(point)으로 나타낸 그래프 한 변수의 변화에 따른 다른 변수의 변화(trend)를 파악하는데 용이 pch - 점(point) 유형 0~14 : 채우기 없음, 테두리 색상만 color로 설정 15~20 : 채우기 색상만 color로 설정, 테두리 없음 21~24 : 채우기 색상은 fill, 테두리 색상은 color로 설정 [예제] birthwt 데이터셋 age : mother’s age in years lwt : mother’s weight in pounds at last menstrual period smoke : smoking status during pregnancy (1=Yes, 0=No) bwt : birth weight in grams ggplot(birthwt, aes(x = age, y = bwt)) + geom_point(size = 3, color = &quot;red&quot;, alpha = 0.5, pch = 17) + geom_rug(position = &quot;jitter&quot;, size = 0.2) + # rug plot 추가 geom_smooth(method = lm) + # 선형 추세선 추가 theme_classic() ggplot(birthwt, aes(x = age, y = bwt)) + geom_point(aes(color = lwt), size = 4, alpha = 0.7, pch = 19) + scale_color_gradient(low = &quot;#FFF59D&quot;, high = &quot;#388E3C&quot;) + labs(color = &quot;mother&#39;s weight&quot;) + theme_classic() ggplot(birthwt, aes(x = age, y = bwt, color = factor(smoke), size = lwt)) + geom_point(alpha = 0.5) + labs(color = &quot;Smoking&quot;, size = &quot;Mother&#39;s weight&quot;) + scale_color_discrete(labels = c(&quot;No&quot;, &quot;Yes&quot;)) 7.3.7 선 그래프(line plot) 한 변수의 변화에 따른 다른 변수의 변화를 선(line)으로 연결하여 나타낸 그래프 일반적으로 x축에는 시간 변수가 종종 사용됨 연속형 변수는 보통 몇 개의 이산적인 값을 취하는 경우를 다룸 범주형 변수는 순서가 있는 경우에만 가능 ## Example 1 # 시간에 따른 이름에 &quot;x&quot;가 포함되는 아기의 비율 변화 library(babynames) babynames %&gt;% group_by(year) %&gt;% summarise(prop_x = mean(str_detect(name, &quot;x&quot;))) %&gt;% ggplot(aes(year, prop_x)) + geom_line() [예제] gapminder 데이터셋 continent : factor with 5 levels year : ranges from 1952 to 2007 in increments of 5 years lifeExp : life expectancy at birth, in years ## Example 2 # 시간에 따른 대륙별 평균 수명의 중앙값 변화 library(gapminder) gapminder %&gt;% group_by(continent, year) %&gt;% summarise(lifeExp = median(lifeExp)) %&gt;% ggplot(aes(x = year, y = lifeExp, color = continent)) + geom_line(size=1) + geom_point(size=1.5) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
